---
title: "Project 1"
author: "Cassandra"
date: "2/17/2018"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
library(dplyr)
library(rwunderground)
library(geosphere)
library(lubridate)
library(chron)
library(ggplot2)
library(ggthemes)
library(gridExtra)

bikesample <- read.csv("Sample_Citibike_Data.csv")
```

Our team at TO414 Consultants Group took time to analyze CitiBike data from Jan 2016 to Sep 2016. The following report outlines major bike ridership patterns in respect to several variables, including gender, age groups, seasons, and weather data. 

#Question 1

Explore the dataset to calculate descriptive statistics. Do exploratory visualization to better understand the dataset.

Here, we have provided summary of the riders' trip duration in minutes, their age, gender proportions, and the most popular starting and ending bike stations. 
```{r, code_folding: hide}
#tripduration
bikesample$minutes <- bikesample$tripduration / 60
print(summary(bikesample$minutes))

#age
bikesample$age <- 2016-bikesample$birth.year
summary(bikesample$age)
```

We also looked deeper at age data to better understand CitiBike riders. First, we separated ages into different groups. We have classified riders 20 years old or under as Teens, riders 21 to 30 years old as Young Adults, riders 31 to 60 as Adults, and riders over 61 and Seniors. 

```{r}
#separating ages into different groups, specified in comments above
age1 <- subset(bikesample, age <= 20) #1190 observations
age2 <- subset(bikesample, age >= 21 & age <= 30) #26185 observations
age3 <- subset(bikesample, age >= 31 & age <= 40) #28984 observations
age4 <- subset(bikesample, age >= 41 & age <= 50) #17732 observations
age5 <- subset(bikesample, age >= 51 & age <= 60) #11626 observations
age6 <- subset(bikesample, age >= 61 & age <= 70) #3539 observations
age7 <- subset(bikesample, age >= 71 & age <= 80) #466 observations
age8 <- subset(bikesample, age >= 81) #48 observations, some of these ages are reaaaaally large though, max age is 131

ageTeens <- age1
ageYoungAdults <- age2
ageAdults <- merge(age3, age4, all = TRUE)
ageAdults <- merge(ageAdults, age5, all = TRUE)
ageSeniors <- merge(age6, age7, all = TRUE)
ageSeniors <- merge(ageSeniors, age8, all = TRUE)
```

We first looked at how trip duration varied for the different age groups. 

```{r}
boxplot(ageTeens$tripduration, ageYoungAdults$tripduration, ageAdults$tripduration, ageSeniors$tripduration, main = "Trip Duration", ylab = "Trip Duration (Seconds)", names = c("Teens", "Young Adults", "Adults", "Seniors"), outline=FALSE) 
```

These boxplots show that the median trip duration in seconds was the lowest for Teens and the highest for Seniors. This prompted the discussion for  comparing biking distances and speeds for the age groups. 

```{r}
ageTeens$distance <- mapply(function(lon1, lat1, lon2, lat2) distm(c(lon1,lat1), c(lon2, lat2)), ageTeens$start.station.longitude, ageTeens$start.station.latitude, ageTeens$end.station.longitude, ageTeens$end.station.latitude) 

ageYoungAdults$distance <- ageYoungAdults$distance <- mapply(function(lon1, lat1, lon2, lat2) distm(c(lon1,lat1), c(lon2, lat2)), ageYoungAdults$start.station.longitude, ageYoungAdults$start.station.latitude, ageYoungAdults$end.station.longitude, ageYoungAdults$end.station.latitude) 

ageAdults$distance <- mapply(function(lon1, lat1, lon2, lat2) distm(c(lon1,lat1), c(lon2, lat2)), ageAdults$start.station.longitude, ageAdults$start.station.latitude, ageAdults$end.station.longitude, ageAdults$end.station.latitude)

ageSeniors$distance <- mapply(function(lon1, lat1, lon2, lat2) distm(c(lon1,lat1), c(lon2, lat2)), ageSeniors$start.station.longitude, ageSeniors$start.station.latitude, ageSeniors$end.station.longitude, ageSeniors$end.station.latitude)

boxplot(ageTeens$distance, ageYoungAdults$distance, ageAdults$distance, ageSeniors$distance,  main = "Trip Distance", ylab = "Trip Distance (Meters)", names = c("Teens", "Young Adults", "Adults", "Seniors"), outline = FALSE) 
``` 

While analyzing the data provided for distance, we noticed that some distances were showing up as 0, even though the time duration was positive. This means that the start location and end location were the same, and it wasn't possible to gauge the distance that the biker had actually traveled. 

Regardless, these boxplots show that the trip distance in meters was the lowest for Teens (which makes sense as they have the lowest trip duration as well). However, although seniors had the highest trip duration, they have the second lowest trip distance. Thus, we came to the conclusion that we should look at speed as well. To get speed, we used the speed formula (speed = distance / time).

```{r}
#getting average speed of the trip by doing sped = distance (meters) / time (second)
ageTeens$speed <- ageTeens$distance / ageTeens$tripduration #unit is meters per second
ageYoungAdults$speed <- ageYoungAdults$distance / ageYoungAdults$tripduration
ageAdults$speed <- ageAdults$distance / ageAdults$tripduration
ageSeniors$speed <- ageSeniors$distance / ageSeniors$tripduration

boxplot(ageTeens$speed, ageYoungAdults$speed, ageAdults$speed, ageSeniors$speed,  main = "Trip Speed", ylab = "Speed (meters / second)", names = c("Teens", "Young Adults", "Adults", "Seniors"), outline = FALSE) 

summary(ageTeens$speed)
summary(ageYoungAdults$speed)
summary(ageAdults$speed)
summary(ageSeniors$speed)
```

Here, we can see that senior bikers were indeed biking at lower speeds than their younger counterparts. Compared to young adults, who were on average biking the fastest out of all the age groups, seniors were biking approximately 0.376 m/s slower. Additionally, we now see that young adults are biking at the fastest average speed, which explains why even though they have the highest trip distance, they don't have the highest trip duration.

We performed the same calculations to see how speed varied between males and females. 

```{r}
genderM <- subset(bikesample, gender == 1)
genderF <- subset(bikesample, gender == 2)

genderM$distance <- mapply(function(lon1, lat1, lon2, lat2) distm(c(lon1,lat1), c(lon2, lat2)), genderM$start.station.longitude, genderM$start.station.latitude, genderM$end.station.longitude, genderM$end.station.latitude) 

genderF$distance <- mapply(function(lon1, lat1, lon2, lat2) distm(c(lon1,lat1), c(lon2, lat2)), genderF$start.station.longitude, genderF$start.station.latitude, genderF$end.station.longitude, genderF$end.station.latitude) 

genderM$speed <- genderM$distance / genderM$tripduration
genderF$speed <- genderF$distance / genderF$tripduration

boxplot(genderM$speed, genderF$speed,  main = "Trip Speed by Gender", ylab = "Speed (meters / second)", names = c("Male", "Female"), outline = FALSE) 
```

Delving deeper into the data extracted above, we wanted to visually see the distances that bikers traveled separated by age, as well as the speeds that bikers traveled at separated by age, both of which can be seen in the plots below. The first plot shows the distances riders travel visually separated by age, and the second plot shows that the speeds riders travel at visually separated by age. Seniors are clearly traveling at lower speeds than young adults. 

```{r}
bikesample$distance <- mapply(function(lon1, lat1, lon2, lat2) distm(c(lon1,lat1), c(lon2, lat2)), bikesample$start.station.longitude, bikesample$start.station.latitude, bikesample$end.station.longitude, bikesample$end.station.latitude)

bikesample$speed <- bikesample$distance / bikesample$tripduration

bikesample$ageID <- ifelse(bikesample$age <= 20, 1, ifelse(bikesample$age >= 21 & bikesample$age <= 30, 2, ifelse(bikesample$age >= 31 & bikesample$age <= 60, 3, 4)))

plot1 <- ggplot() + geom_jitter(aes(y = bikesample$distance, x = bikesample$age, colour = bikesample$ageID), data = bikesample, stat="identity")
plot1

plot2 <- ggplot() + geom_jitter(aes(y = bikesample$speed, x = bikesample$age, colour = bikesample$ageID), data = bikesample, stat="identity")
plot2
```

Next, we wanted to look at if there were some times where more people of the same age group (ex. teenagers) came out to bike compared to other times of the day. These graphs show the different times that Teens, Young Adults, Adults, and Seniors often use CitiBike. 

```{r}
ageTeens$starttime <- as.POSIXlt(ageTeens$starttime, tz = "", "%m/%d/%Y %H:%M:%OS", optional = FALSE)
ageTeens$stoptime <- as.POSIXlt(ageTeens$stoptime, tz = "", "%m/%d/%Y %H:%M:%OS", optional = FALSE)

ageTeens$month <- month(ageTeens$starttime) #helps with seasons
ageTeens$hour <- hour(ageTeens$starttime) #helps with time of day
ageTeens$hour <- ifelse((minute(ageTeens$starttime) >= 16 & minute(ageTeens$starttime) <= 30), ageTeens$hour+0.25, ageTeens$hour)
ageTeens$hour <- ifelse((minute(ageTeens$starttime) >= 31 & minute(ageTeens$starttime) <= 45), ageTeens$hour+0.5, ageTeens$hour)
ageTeens$hour <- ifelse((minute(ageTeens$starttime) >= 46 & minute(ageTeens$starttime) <= 60), ageTeens$hour+0.75, ageTeens$hour)

numTeensHours <- seq(from = 0, to = 23.75, by = 0.25)
numTeensHoursAt <- numeric(length(numTeensHours))
for(i in 1:length(numTeensHours)) {
  numTeensHoursAt[i] = length(which(ageTeens$hour == numTeensHours[i])) 
}

numTeensHours$numHours <- as.data.frame(numTeensHours)
numTeensHoursAt <- as.data.frame(numTeensHoursAt)
teens <- cbind(numTeensHours, numTeensHoursAt)

teensPlot <- ggplot(data = teens, aes(x=numTeensHours, y=numTeensHoursAt)) + geom_line() + geom_smooth()

ageYoungAdults$starttime <- as.POSIXlt(ageYoungAdults$starttime, tz = "", "%m/%d/%Y %H:%M:%OS", optional = FALSE)
ageYoungAdults$stoptime <- as.POSIXlt(ageYoungAdults$stoptime, tz = "", "%m/%d/%Y %H:%M:%OS", optional = FALSE)

ageYoungAdults$month <- month(ageYoungAdults$starttime) #helps with seasons
ageYoungAdults$hour <- hour(ageYoungAdults$starttime) #helps with time of day
ageYoungAdults$hour <- ifelse((minute(ageYoungAdults$starttime) >= 16 & minute(ageYoungAdults$starttime) <= 30), ageYoungAdults$hour+0.25, ageYoungAdults$hour)
ageYoungAdults$hour <- ifelse((minute(ageYoungAdults$starttime) >= 31 & minute(ageYoungAdults$starttime) <= 45), ageYoungAdults$hour+0.5, ageYoungAdults$hour)
ageYoungAdults$hour <- ifelse((minute(ageYoungAdults$starttime) >= 46 & minute(ageYoungAdults$starttime) <= 60), ageYoungAdults$hour+0.75, ageYoungAdults$hour)

numYoungAdultsHours <- seq(from = 0, to = 23.75, by = 0.25)
numYoungAdultsHoursAt <- numeric(length(numYoungAdultsHours))
for(i in 1:length(numYoungAdultsHours)) {
  numYoungAdultsHoursAt[i] = length(which(ageYoungAdults$hour == numYoungAdultsHours[i])) 
}

numYoungAdultsHours$numHours <- as.data.frame(numYoungAdultsHours)
numYoungAdultsHoursAt <- as.data.frame(numYoungAdultsHoursAt)
youngAdults <- cbind(numYoungAdultsHours, numYoungAdultsHoursAt)

youngAdultsPlot <- ggplot(data = youngAdults, aes(x=numYoungAdultsHours, y=numYoungAdultsHoursAt)) + geom_line() + geom_smooth()

ageAdults$starttime <- as.POSIXlt(ageAdults$starttime, tz = "", "%m/%d/%Y %H:%M:%OS", optional = FALSE)
ageAdults$stoptime <- as.POSIXlt(ageAdults$stoptime, tz = "", "%m/%d/%Y %H:%M:%OS", optional = FALSE)

ageAdults$month <- month(ageAdults$starttime) #helps with seasons
ageAdults$hour <- hour(ageAdults$starttime) #helps with time of day
ageAdults$hour <- ifelse((minute(ageAdults$starttime) >= 16 & minute(ageAdults$starttime) <= 30), ageAdults$hour+0.25, ageAdults$hour)
ageAdults$hour <- ifelse((minute(ageAdults$starttime) >= 31 & minute(ageAdults$starttime) <= 45), ageAdults$hour+0.5, ageAdults$hour)
ageAdults$hour <- ifelse((minute(ageAdults$starttime) >= 46 & minute(ageAdults$starttime) <= 60), ageAdults$hour+0.75, ageAdults$hour)

numAdultHours <- seq(from = 0, to = 23.75, by = 0.25)
numAdultHoursAt <- numeric(length(numAdultHours))
for(i in 1:length(numAdultHours)) {
  numAdultHoursAt[i] = length(which(ageAdults$hour == numAdultHours[i])) 
}

numAdultHours$numHours <- as.data.frame(numAdultHours)
numAdultHoursAt <- as.data.frame(numAdultHoursAt)
adults <- cbind(numAdultHours, numAdultHoursAt)

adultsPlot <- ggplot(data = adults, aes(x=numAdultHours, y=numAdultHoursAt)) + geom_line() + geom_smooth()

ageSeniors$starttime <- as.POSIXlt(ageSeniors$starttime, tz = "", "%m/%d/%Y %H:%M:%OS", optional = FALSE)
ageSeniors$stoptime <- as.POSIXlt(ageSeniors$stoptime, tz = "", "%m/%d/%Y %H:%M:%OS", optional = FALSE)

ageSeniors$month <- month(ageSeniors$starttime) #helps with seasons
ageSeniors$hour <- hour(ageSeniors$starttime) #helps with time of day
ageSeniors$hour <- ifelse((minute(ageSeniors$starttime) >= 16 & minute(ageSeniors$starttime) <= 30), ageSeniors$hour+0.25, ageSeniors$hour)
ageSeniors$hour <- ifelse((minute(ageSeniors$starttime) >= 31 & minute(ageSeniors$starttime) <= 45), ageSeniors$hour+0.5, ageSeniors$hour)
ageSeniors$hour <- ifelse((minute(ageSeniors$starttime) >= 46 & minute(ageSeniors$starttime) <= 60), ageSeniors$hour+0.75, ageSeniors$hour)

numSeniorHours <- seq(from = 0, to = 23.75, by = 0.25)
numSeniorHoursAt <- numeric(length(numSeniorHours))
for(i in 1:length(numSeniorHours)) {
  numSeniorHoursAt[i] = length(which(ageSeniors$hour == numSeniorHours[i])) 
}

numSeniorHours$numHours <- as.data.frame(numSeniorHours)
numSeniorHoursAt <- as.data.frame(numSeniorHoursAt)
seniors <- cbind(numSeniorHours, numSeniorHoursAt)

seniorsPlot <- ggplot(data = seniors, aes(x=numSeniorHours, y=numSeniorHoursAt)) + geom_line() + geom_smooth()

grid.arrange(teensPlot, youngAdultsPlot, adultsPlot, seniorsPlot)
```

Next, we looked at gender proportions in the data.

```{r}
malecount= length(which(bikesample$gender==1)) #number of male riders
femalecount= length(which(bikesample$gender==2)) #number of female riders
malepercent= malecount/(malecount+femalecount) #proporation of male riders who use citi bike
femalepercent= femalecount/(malecount+femalecount) ##proporation of female riders who use citi bike

cat("The number of male riders is", malecount, ", and the number of female riders is", femalecount, ". With these numbers we can calculate the proportion of male riders who use CitiBikes, which is", malepercent, ", and the proportion of female riders who use CitiBikes, which is", femalepercent, ".")
```

Lastly, we wanted to see where the most popular stations riders went to for either starting or ending their trip, which could help us develop a marketing plan to increase ridership for CitiBikes when all the above data is also taken into account. The following map shows the top 20 stations riders go to. 

```{r}
#Extract the numbers of leaves and arrivals from the data set 
start_station <- as.data.frame(table(bikesample$start.station.name))
end_station <- as.data.frame(table(bikesample$end.station.name))

#Extract the location of stations from the data set and omit the repeaded lines
names_coor <- data.frame(bikesample$start.station.name,bikesample$start.station.latitude,bikesample$start.station.longitude)
deduped.names_coor <- unique(names_coor)

#Combine the data frames together and calculate the out-bike ratio
stations <- merge(start_station,end_station,by.x="Var1",by.y="Var1")
stations_coor <- merge(stations,deduped.names_coor,by.x="Var1",by.y="bikesample.start.station.name")

stations_coor$bike_avg <- (stations_coor$Freq.x+stations_coor$Freq.y)/2
popular_stations <- stations_coor[order(-stations_coor$bike_avg),][1:20,]

map1 <- get_googlemap(center = c(lon = -73.989, lat = 40.74), zoom = 13,size = c(640, 640))

#plot the selected bike stations onto the google map and displace the points' color according to the degree that the staion is running out of bikes
ggmap(map1)+geom_point(data = popular_stations , aes(x = bikesample.start.station.longitude, y = bikesample.start.station.latitude), size = 4, shape = 21,fill="Blue") 
```

#Question 2

Identify patterns in the ride history data. Explain/illustrate these patterns using appropriate visualization.

First, we delved into looking at gender data. We wanted to know what the proportion of Male and Female riders was. 
```{r}
malecount= length(which(bikesample$gender==1)) #number of male riders
femalecount= length(which(bikesample$gender==2)) #number of female riders
malepercent= malecount/(malecount+femalecount) #proporation of male riders who use citi bike
femalepercent= femalecount/(malecount+femalecount) ##proporation of female riders who use citi bike
slices <- c(malecount, femalecount)
lbls <- c("Male Riders", "Female Riders")
pct <- round(slices/sum(slices)*100)
lbls <- paste(lbls, pct) 
lbls <- paste(lbls,"%",sep="") 
colors= c("blue", "pink")
pie(slices,labels = lbls, col= colors ,main="Gender Breakdown of Citi Bikes")
```

Due to such low female ridership, we looked into two possible causes. First, we looked into time of day females tend to use bikes to see if safety may be an issue. 

```{r}
femaletime=  subset(bikesample, gender == 2)
femaletime$startHours <- as.POSIXlt(femaletime$starttime, format = "%m/%d/%Y %H:%M")$hour
barplot(table(femaletime$startHours), ylab = "Number of Female Rides over an Entire Year", xlab = "Hour of Departure", col= "pink")
title("Number of Monthly Female Riders by Hour of Departure")
```

The peak hours of bike usage by women are 8:00 AM and 5:00-6:00 PM indicating that women seem to be using the bikes of commuting. 

```{r}
maletime=  subset(bikesample, gender == 1)
maletime$startHours <- as.POSIXlt(maletime$starttime, format = "%m/%d/%Y %H:%M")$hour
barplot(table(maletime$startHours), ylab = "Number of Male Rides over an Entire Year", xlab = "Hour of Departure", col= "blue")
title("Number of Monthly Male Riders by Hour of Departure")
```

The peak hours for bike usage by men are the same as women indicating that men are allso using bikes for commuting. Since the bike usage by both genders are so similar with bike usage dropping off for both late into the night, time of the day in regards to safety does not seem to be a major issue for why women are using the bikes less than men. However, safety of riding on busy streets may be a determinant resulting in less women using bikes in the first place. Citi bike may want to look into creating more protected bike lanes along with releasing bike driving statistics about safety to convince more women to try the bikes. 

Next, we looked into the day of week women tend to use bikes to see if women use the bikes primarily for commuting or for a different reason more on the weekends. 

```{r}
bikesample$weekday <- weekdays(as.Date(bikes$date))
bikesample$weekday <- ordered(bikesample$weekday, levels = c("Sunday","Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"))
femaleday= subset(bikesample, gender==2)
barplot(table(femaleday$weekday), ylab = "Number of Monthly Female Riders by Day of Week", xlab ="Day", col= "pink")
title("Number of Monthly Citibike Riders by Day")
```

Bike riding is highest during the five work days indicating that job commuting may be the reason women are using the bikes most. We then decided to check male ridership per day to see if there was a greater contrast between weekdays vs. weekends for men compared to women.

```{r}
maleday= subset(bikesample, gender==1)
barplot(table(maleday$weekday), ylab = "Number of Monthly Male Riders by Day of Week", xlab ="Day", col= "blue")
title("Number of Monthly Citibike Riders by Day")
```

This graph compared to the female graph shows a greater difference from weekday riding versus weekend riding. On the male graph, the gap when looking at Sunday (6000) compared to Monday (10000) is 4000. The difference when looking at the female rider graph at Sunday (2500) compared to Monday (3000) is 500. This reveals the possibility that overall there are more male riders who are choosing bike transportation for commuting as opposed women. Women may be looking into other transportation options. 

Consequently, Citi Bike may want to consider highlighting more pros of their bike service that appeal to women to help steal share from other transportation options. 

Additionally, we conducted seasonal analysis foor number of riders. It can be seen that winter has the lowest number of bikes used. Since the the bikes have already been purchased, unused bikes represent lost revenue. Consequnetly, Citi may want to conisder offering greater promotions in the winter or investing in winter bike wheels to promote which could lead to more people considering bikes a vaiable option even in the colder months. Furthermore, Fall and Summer seem to have greater bike usage so pricing higher in these seasons may help Citi make up for loses in the winter. 

```{r}
bikesample$startHours <- as.POSIXlt(bikesample$starttime, format = "%m/%d/%Y %H:%M")$hour
bikesample$date <- as.Date(bikesample$starttime, "%m/%d/%Y %H:%M")
bikesample$weekday <- weekdays(as.Date(bikesample$date))
bikesample$Month <- format(bikesample$date,"%m")
bikesample$Month = as.numeric(as.character(bikesample$Month))
bikesample$Season<-ifelse(bikesample$Month == 1,"Winter",
		ifelse(bikesample$Month== 2,"Winter",
		ifelse(bikesample$Month== 3,"Spring", 
		ifelse(bikesample$Month== 4,"Spring",
		ifelse(bikesample$Month== 5,"Spring",
		ifelse(bikesample$Month== 6,"Summer",
		ifelse(bikesample$Month== 7,"Summer",
		ifelse(bikesample$Month== 8,"Summer","Fall"))))))))

spring= length(which(bikesample$Season=="Spring"))/3
summer= length(which(bikesample$Season=="Summer"))/3
winter= length(which(bikesample$Season=="Winter"))/2
fall= length(which(bikesample$Season=="Fall"))

J = c(fall, winter, spring, summer)
barplot(J, main="Number of Bikes Used per Season on Average", xlab= "Season",col=c("red","darkblue", "green", "yellow"), ylab="Number of riders", names.arg = c("Fall", "Winter", "Spring", "Summer")) 
```

#Question 3

Assymetric Traffic: Stations running out of bikes because of assymetric traffic (arrivals and departures are not equal) is a big problem. Client would want to know which stations are candidates for increasing bike storage capacity. Client would like to see these stations on a map based visualization.
```{r}
#Extract the numbers of leaves and arrivals from the data set 
start_station <- as.data.frame(table(bikesample$start.station.name))
end_station <- as.data.frame(table(bikesample$end.station.name))

#Extract the location of stations from the data set and omit the repeaded lines
names_coor <- data.frame(bikesample$start.station.name, bikesample$start.station.latitude, bikesample$start.station.longitude) 
deduped.names_coor <- unique(names_coor)

#Combine the data frames together and calculate the out-bike ratio
stations <- merge(start_station,end_station,by.x="Var1",by.y="Var1")
stations_coor <- merge(stations,deduped.names_coor,by.x="Var1",by.y="bikesample.start.station.name")
stations_coor$out_bike_ratio =stations_coor[,3]/stations_coor[,2]-1

#Import the related libraries
if(!require('ggmap')){
  install.packages('ggmap', repos = "http://cran.us.r-project.org")
  library(ggmap)
}

if(!require('ggplot2')){
  install.packages('ggplot2', repos = "http://cran.us.r-project.org")
  library(ggplot2)
}

#select the stations to plot
stations_coor_selected <- stations_coor[stations_coor$out_bike_ratio>0.2,]

#plot the google map in R
map <- get_googlemap(center = c(lon = -73.97, lat = 40.73), zoom = 12,size = c(640, 640))

#plot the selected bike stations onto the google map and displace the points' color according to the degree that the staion is running out of bikes
ggmap(map)+geom_point(data = stations_coor_selected, aes(x = bikesample.start.station.longitude, y = bikesample.start.station.latitude,fill = out_bike_ratio), size = 2, shape = 21,show.legend = TRUE) + scale_fill_gradient(low = "#0000FF", high = "#FF0000")

#Print the names
print(stations_coor_selected[,1])
```


#Question 4

Impact of Weather. Client wants to know the impact of weather (temperature, rain, snow, wind) on the CitiBike system. 
```{r}
#linear regression, tempearture as y, behavior as x
```